schema: '2.0'
stages:
  data_ingestion:
    cmd: python src/data_ingestion.py --output data/raw
    deps:
    - path: src/data_ingestion.py
      hash: md5
      md5: ff7f329adc158fdcee8eadb57a83388c
      size: 1731
    outs:
    - path: data/raw/medical_chatbot_raw.csv
      hash: md5
      md5: 1d49cdcbeb950f858ec095319ae198f6
      size: 267520764
  data_preprocessing:
    cmd: python src/data_preprocessing.py --input 
      data/raw/medical_chatbot_raw.csv --output data/processed
    deps:
    - path: data/raw/medical_chatbot_raw.csv
      hash: md5
      md5: 1d49cdcbeb950f858ec095319ae198f6
      size: 267520764
    - path: src/data_preprocessing.py
      hash: md5
      md5: d67b4809ec6e17fa771c03143222f023
      size: 2414
    outs:
    - path: data/processed/train.jsonl
      hash: md5
      md5: 2b141932642dc2497e724aa7113e7431
      size: 1071048
    - path: data/processed/val.jsonl
      hash: md5
      md5: 806e7dedfcd158058a986d6fcf4b3be7
      size: 121432
  data_processing:
    cmd: python src/data_processing.py --input_dir data/processed --output_dir 
      data/tokenized --model_id Qwen/Qwen2.5-0.5B-Instruct
    deps:
    - path: data/processed/train.jsonl
      hash: md5
      md5: 2b141932642dc2497e724aa7113e7431
      size: 1071048
    - path: data/processed/val.jsonl
      hash: md5
      md5: 806e7dedfcd158058a986d6fcf4b3be7
      size: 121432
    - path: src/data_processing.py
      hash: md5
      md5: 9e40e60b8fbec5e94bbe71da1811939b
      size: 3516
    outs:
    - path: data/tokenized/train
      hash: md5
      md5: 31a1a6e8f7de6701fcd023b0c52c7ad2.dir
      size: 2567504
      nfiles: 3
    - path: data/tokenized/val
      hash: md5
      md5: 1e31dec7d565aec9f747abf3fcebd761.dir
      size: 291694
      nfiles: 3
  model_building:
    cmd: python src/model_building.py --input_dir data/tokenized --output_dir 
      models/qwen-medical-finetuned
    deps:
    - path: data/tokenized/
      hash: md5
      md5: acd113bb5886eef4b2252f19187bbf13.dir
      size: 2859212
      nfiles: 7
    - path: src/data_processing.py
      hash: md5
      md5: 9e40e60b8fbec5e94bbe71da1811939b
      size: 3516
    - path: src/model_building.py
      hash: md5
      md5: 10cc1e7de8316459ae95ce5dc49e41ab
      size: 4096
    outs:
    - path: models/qwen-medical-finetuned/final_adapter
      hash: md5
      md5: a7185a09270a2751444f8163d84a51b0.dir
      size: 24567414
      nfiles: 11
  model_evaluating:
    cmd: python src/model_evaluating.py --val_file data/processed/val.jsonl 
      --output_metrics metrics.json --vectorstore_path data/rag_vectorstore
    deps:
    - path: data/processed/val.jsonl
      hash: md5
      md5: 806e7dedfcd158058a986d6fcf4b3be7
      size: 121432
    - path: data/rag_vectorstore
      hash: md5
      md5: 4211b85060192d9f61d86f46a4b4ab8c.dir
      size: 2770194
      nfiles: 2
    - path: models/qwen-medical-finetuned/final_adapter
      hash: md5
      md5: a7185a09270a2751444f8163d84a51b0.dir
      size: 24567414
      nfiles: 11
    - path: src/model_RAG.py
      hash: md5
      md5: fab496aeaf465ad4165b6c94e87e318d
      size: 9464
    - path: src/model_evaluating.py
      hash: md5
      md5: c8389f383a197ef27edc726a1eaaf683
      size: 9028
    outs:
    - path: metrics.json
      hash: md5
      md5: c1ff2413f4bf81509ead9d72e9af70b8
      size: 586
  model_rag:
    cmd: python src/model_RAG.py --model_base_id Qwen/Qwen2.5-0.5B-Instruct 
      --adapter_path models/qwen-medical-finetuned/final_adapter 
      --vectorstore_path data/rag_vectorstore
    deps:
    - path: models/qwen-medical-finetuned/final_adapter
      hash: md5
      md5: a7185a09270a2751444f8163d84a51b0.dir
      size: 24567414
      nfiles: 11
    - path: src/model_RAG.py
      hash: md5
      md5: fab496aeaf465ad4165b6c94e87e318d
      size: 9464
    outs:
    - path: data/rag_vectorstore
      hash: md5
      md5: 4211b85060192d9f61d86f46a4b4ab8c.dir
      size: 2770194
      nfiles: 2
